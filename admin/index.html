<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>记账应用 - 后台管理系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="login.css">
    <!-- 避免本地字体文件引用问题 -->
</head>
<body>
    <div id="loginContainer">
        <div class="login-container">
            <div class="login-header">
                <h1>🔐 管理员登录</h1>
                <p>请输入管理员凭据访问后台系统</p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username"><i class="fas fa-user"></i> 用户名</label>
                    <input type="text" id="username" name="username" placeholder="请输入管理员用户名" required>
                    <i class="fas fa-user input-icon"></i>
                </div>
                
                <div class="form-group">
                    <label for="password"><i class="fas fa-lock"></i> 密码</label>
                    <input type="password" id="password" name="password" placeholder="请输入管理员密码" required>
                    <i class="fas fa-lock input-icon"></i>
                </div>
                
                <button type="submit" class="btn-login">
                    <i class="fas fa-sign-in-alt"></i> 登录系统
                </button>
                
                <div class="error-message" id="errorMessage">
                    <i class="fas fa-exclamation-triangle"></i> 登录失败，请检查用户名和密码
                </div>
                
                <div class="success-message" id="successMessage">
                    <i class="fas fa-check-circle"></i> 登录成功，正在跳转...
                </div>
            </form>
            
            <div class="demo-credentials">
                <h4><i class="fas fa-info-circle"></i> 演示凭据</h4>
                <div class="credential-item">
                    <i class="fas fa-user"></i>
                    <span><strong>用户名:</strong> admin</span>
                </div>
                <div class="credential-item">
                    <i class="fas fa-key"></i>
                    <span><strong>密码:</strong> admin123</span>
                </div>
                <p class="demo-note"><i class="fas fa-exclamation-triangle"></i> 这是演示环境的默认凭据</p>
            </div>
        </div>
    </div>
    
    <div id="adminContainer" class="hidden-container">
        <!-- 这里会加载admin.html内容 -->
    </div>

    <script src="login.js"></script>
    <script>
        // 动态加载管理页面 - 最终修复版
        window.addEventListener('load', function() {
            const adminContainer = document.getElementById('adminContainer');
            if (adminContainer) {
                console.log('开始加载管理页面...');
                
                fetch('admin.html')
                    .then(response => response.text())
                    .then(html => {
                        console.log('HTML内容加载成功');
                        adminContainer.innerHTML = html;
                        
                        // 创建并加载管理脚本
                        const script = document.createElement('script');
                        script.src = 'admin.js';
                        script.type = 'module';
                        
                        script.onload = function() {
                            console.log('✅ 后台管理脚本加载完成');
                            
                            // 检查admin对象是否已创建
                            if (typeof window.admin !== 'undefined' && window.admin !== null) {
                                console.log('✅ admin对象已存在，开始初始化...');
                                
                                // 延迟初始化以确保DOM完全加载
                                setTimeout(() => {
                                    if (typeof window.admin.init === 'function') {
                                        window.admin.init();
                                        console.log('✅ 后台管理系统初始化完成');
                                        
                                        // 测试页面跳转功能
                                        console.log('页面跳转功能已就绪，点击导航链接测试');
                                    } else {
                                        console.error('❌ admin.init() 方法不存在');
                                    }
                                }, 100);
                            } else {
                                console.error('❌ admin对象未创建，请检查脚本');
                            }
                        };
                        
                        script.onerror = function() {
                            console.error('❌ 加载管理脚本失败，请检查文件路径');
                        };
                        
                        document.body.appendChild(script);
                    })
                    .catch(error => {
                        console.error('❌ 加载管理页面失败:', error);
                    });
            } else {
                console.error('❌ adminContainer 元素未找到');
            }
        });
    </script>
</body>
</html>